---
title: "rep_res"
author: "Sayyad Ali Raza Bukhari"
date: "8/25/2021"
output: html_document
---

```{r echo=TRUE}
library(tidyverse)
library(lubridate)
#1. Code for reading in the dataset and/or processing the data
df <- read.csv("activity.csv")
```

## Including Plots

You can also embed plots, for example:

```{r echo=TRUE}
#2. Histogram of the total number of steps taken each day
df %>% group_by(date) %>% ggplot(aes(steps)) +
  geom_histogram()
```

```{r echo=TRUE}
#3. Mean and median number of steps taken each day
df %>% group_by(date) %>% summarise(mean = mean(steps),
                                    median = median(steps))
```

```{r echo=TRUE}
#4. Time series plot of the average number of steps taken
df %>% group_by(interval) %>% 
  summarise(mean = mean(steps, na.rm = TRUE),
            median = median(steps), .groups = "drop") %>% 
  ggplot(aes(interval, mean)) +
  geom_line() 

```

```{r echo=TRUE}
#5. The 5-minute interval that, on average, contains 
#the maximum number of steps
df %>% group_by(interval) %>% 
  summarise(mean = mean(steps, na.rm = T)) %>%
  slice_max(order_by = mean)
```

```{r echo=TRUE}
#6. Code to describe and show a strategy for imputing missing data
df %>% fill(steps, .direction = "up") %>% fill(steps, .direction = "down")
```

```{r echo=TRUE}
#7. Histogram of the total number of steps taken each
#day after missing values are imputed

df %>% fill(steps, .direction = "up") %>% fill(steps, .direction = "down") %>% 
  group_by(date) %>% ggplot(aes(steps)) +
  geom_histogram()
```

```{r echo=TRUE}
#8. Panel plot comparing the average number of steps taken 
#per 5-minute interval across weekdays and weekends

df %>% fill(steps, .direction = "up") %>% fill(steps, .direction = "down") %>%
  mutate(date = ymd(date)) %>% 
  mutate(day = wday(date, label = TRUE)) %>% 
  mutate(weekday = 
           ifelse(day == "Sun" | day == "Sat", "Weekend", "Weekday")) %>%
  group_by(weekday, interval) %>% summarise(steps = mean(steps), .groups = "drop") %>% 
  ggplot(aes(interval, steps)) +
  geom_line() +
  facet_wrap(~weekday)
```


